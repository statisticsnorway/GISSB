library(xml2)
# OBS: hvordan velge årgang?
test <- "http://statistikkbank.fhi.no/mfr/velocity?v=2&mode=cube&cube=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfCube%2Fmfr1b_C1&study=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfStudy%2Fmfr1b&context=http%3A%2F%2Fstatistikkbank.fhi.no%3A80%2Fobj%2FfCatalog%2FCatalog2"
fhi_mfr <- read_html(test)
fhi_mfr_2 <- fhi_mfr %>% html_table()
data <- fhi_mfr_2[[3]]
data <- data[-c(1), ]
colnames(data) = data[1, ]
data <- data[-c(1:3), ]
str_trim("100 000")
colnames(data)[1] <- "fodested"
colnames(data)[2] <- "fodte"
length()
nchar(123)
data <- data %>%
# dplyr::rename(fodested = Fødselsmåned) %>%
# dplyr::filter(!fodested %in% c("Ikke inst.reg", "Ukjent helseregion", "Alle fødeinstitusjoner", "Oslo univ.sh.")) %>%
dplyr::mutate(fodte_2 = nchar(fodte)) # %>%
library(tidyverse)
library(rvest)
library(xml2)
# OBS: hvordan velge årgang?
test <- "http://statistikkbank.fhi.no/mfr/velocity?v=2&mode=cube&cube=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfCube%2Fmfr1b_C1&study=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfStudy%2Fmfr1b&context=http%3A%2F%2Fstatistikkbank.fhi.no%3A80%2Fobj%2FfCatalog%2FCatalog2"
fhi_mfr <- read_html(test)
fhi_mfr_2 <- fhi_mfr %>% html_table()
data <- fhi_mfr_2[[3]]
data <- data[-c(1), ]
colnames(data) = data[1, ]
data <- data[-c(1:3), ]
str_trim("100 000")
colnames(data)[1] <- "fodested"
colnames(data)[2] <- "fodte"
nchar(123)
data <- data %>%
# dplyr::rename(fodested = Fødselsmåned) %>%
# dplyr::filter(!fodested %in% c("Ikke inst.reg", "Ukjent helseregion", "Alle fødeinstitusjoner", "Oslo univ.sh.")) %>%
dplyr::mutate(fodte_2 = gsub(" ", "", fodte)) # %>%
# dplyr::group_by(fodested) %>%
# dplyr::slice(which.min(fodte))
unique(data$fodested)
data$fodte <- gsub(" ", "", data$fodte)
class(data$fodte)
class(data)
library(tidyverse)
library(rvest)
library(xml2)
# OBS: hvordan velge årgang?
test <- "http://statistikkbank.fhi.no/mfr/velocity?v=2&mode=cube&cube=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfCube%2Fmfr1b_C1&study=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfStudy%2Fmfr1b&context=http%3A%2F%2Fstatistikkbank.fhi.no%3A80%2Fobj%2FfCatalog%2FCatalog2"
fhi_mfr <- read_html(test)
fhi_mfr_2 <- fhi_mfr %>% html_table()
data <- fhi_mfr_2[[3]]
data <- data[-c(1), ]
colnames(data) = data[1, ]
data <- data[-c(1:3), ]
str_trim("100 000")
colnames(data)[1] <- "fodested"
colnames(data)[2] <- "fodte"
nchar(123)
class(data)
data$fodte <- gsub(" ", "", data$fodte)
data <- data %>%
data.frame() %>%
# dplyr::rename(fodested = Fødselsmåned) %>%
# dplyr::filter(!fodested %in% c("Ikke inst.reg", "Ukjent helseregion", "Alle fødeinstitusjoner", "Oslo univ.sh.")) %>%
dplyr::mutate(fodte_2 = gsub(" ", "", fodte)) # %>%
# dplyr::group_by(fodested) %>%
# dplyr::slice(which.min(fodte))
unique(data$fodested)
data <- data %>%
data.frame() %>%
# dplyr::rename(fodested = Fødselsmåned) %>%
# dplyr::filter(!fodested %in% c("Ikke inst.reg", "Ukjent helseregion", "Alle fødeinstitusjoner", "Oslo univ.sh.")) %>%
dplyr::mutate(fodte_2 = gsub(" ", "", as.character(fodte))) # %>%
library(tidyverse)
library(rvest)
library(xml2)
# OBS: hvordan velge årgang?
test <- "http://statistikkbank.fhi.no/mfr/velocity?v=2&mode=cube&cube=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfCube%2Fmfr1b_C1&study=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfStudy%2Fmfr1b&context=http%3A%2F%2Fstatistikkbank.fhi.no%3A80%2Fobj%2FfCatalog%2FCatalog2"
fhi_mfr <- read_html(test)
fhi_mfr_2 <- fhi_mfr %>% html_table()
data <- fhi_mfr_2[[3]]
data <- data[-c(1), ]
colnames(data) = data[1, ]
data <- data[-c(1:3), ]
str_trim("100 000")
colnames(data)[1] <- "fodested"
colnames(data)[2] <- "fodte"
nchar(123)
class(data)
data$fodte <- gsub(" ", "", data$fodte)
data <- data %>%
data.frame() %>%
# dplyr::rename(fodested = Fødselsmåned) %>%
# dplyr::filter(!fodested %in% c("Ikke inst.reg", "Ukjent helseregion", "Alle fødeinstitusjoner", "Oslo univ.sh.")) %>%
dplyr::mutate(fodte_2 = gsub(" ", "", as.character(fodte))) # %>%
# dplyr::group_by(fodested) %>%
# dplyr::slice(which.min(fodte))
unique(data$fodested)
library(tidyverse)
library(rvest)
library(xml2)
# OBS: hvordan velge årgang?
test <- "http://statistikkbank.fhi.no/mfr/velocity?v=2&mode=cube&cube=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfCube%2Fmfr1b_C1&study=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfStudy%2Fmfr1b&context=http%3A%2F%2Fstatistikkbank.fhi.no%3A80%2Fobj%2FfCatalog%2FCatalog2"
fhi_mfr <- read_html(test)
fhi_mfr_2 <- fhi_mfr %>% html_table()
data <- fhi_mfr_2[[3]]
data <- data[-c(1), ]
colnames(data) = data[1, ]
data <- data[-c(1:3), ]
str_trim("100 000")
colnames(data)[1] <- "fodested"
colnames(data)[2] <- "fodte"
nchar(123)
class(data)
data$fodte_3 <- gsub(" ", "", data$fodte)
data <- data %>%
data.frame() %>%
# dplyr::rename(fodested = Fødselsmåned) %>%
# dplyr::filter(!fodested %in% c("Ikke inst.reg", "Ukjent helseregion", "Alle fødeinstitusjoner", "Oslo univ.sh.")) %>%
dplyr::mutate(fodte_2 = gsub(" ", "", as.character(fodte))) # %>%
# dplyr::group_by(fodested) %>%
# dplyr::slice(which.min(fodte))
unique(data$fodested)
library(tidyverse)
library(rvest)
library(xml2)
# OBS: hvordan velge årgang?
test <- "http://statistikkbank.fhi.no/mfr/velocity?v=2&mode=cube&cube=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfCube%2Fmfr1b_C1&study=http%3A%2F%2F10.0.3.47%3A80%2Fobj%2FfStudy%2Fmfr1b&context=http%3A%2F%2Fstatistikkbank.fhi.no%3A80%2Fobj%2FfCatalog%2FCatalog2"
fhi_mfr <- read_html(test)
fhi_mfr_2 <- fhi_mfr %>% html_table()
data <- fhi_mfr_2[[3]]
data <- data[-c(1), ]
colnames(data) = data[1, ]
data <- data[-c(1:3), ]
str_trim("100 000")
colnames(data)[1] <- "fodested"
colnames(data)[2] <- "fodte"
nchar(123)
class(data)
data$fodte_3 <- gsub(" ", "", as.character(data$fodte))
data <- data %>%
data.frame() %>%
# dplyr::rename(fodested = Fødselsmåned) %>%
# dplyr::filter(!fodested %in% c("Ikke inst.reg", "Ukjent helseregion", "Alle fødeinstitusjoner", "Oslo univ.sh.")) %>%
dplyr::mutate(fodte_2 = gsub(" ", "", as.character(fodte))) # %>%
# dplyr::group_by(fodested) %>%
# dplyr::slice(which.min(fodte))
unique(data$fodested)
ds <- arrow::open_dataset("C:/Users/rdn/Documents/Kart/isochrones_90.parquet")
ds <- arrow::open_dataset("C:/Users/rdn/Documents/Kart/isochrones_90.parquet")
isochrones <- ds %>%
sfarrow::read_sf_dataset()
library(tidyverse)
ds <- arrow::open_dataset("C:/Users/rdn/Documents/Kart/isochrones_90.parquet")
isochrones <- ds %>%
sfarrow::read_sf_dataset()
alle_2 <- isochrones %>%
dplyr::filter(minutes == 10) %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
View(isochrones)
Sys.setlocale("LC_ALL","no_NB.utf8"
Sys.setlocale("LC_ALL","no_NB.utf8")
isochrones$
alle_2 <- isochrones %>%
dplyr::filter(minutes == 10,
`F<c3>.deinstitusjon` == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
isochrones$
alle_2 <- isochrones %>%
dplyr::filter(minutes == 10,
`Fødeinstitusjon` == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
Sys.setlocale("LC_ALL","no_NB.utf8")
library(tidyverse)
ds <- arrow::open_dataset("C:/Users/rdn/Documents/Kart/isochrones_90.parquet")
isochrones <- ds %>%
sfarrow::read_sf_dataset()
isochrones$`F<c3>.deinstitusjon`
Sys.setlocale("LC_ALL","no_NB.utf8")
library(tidyverse)
ds <- arrow::open_dataset("C:/Users/rdn/Documents/Kart/isochrones_90.parquet")
isochrones <- ds %>%
sfarrow::read_sf_dataset()
View(isochrones)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 10,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 1,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 2,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 3,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 4,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 10,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 15,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 30,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 40,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 60,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 70,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 80,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 90,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
sf::st_write(isochrones, "C:/Users/rdn/Documents/Kart/isochrones_90.shp", delete_dsn = TRUE)
View(alle_2)
View(isochrones)
isochrones
fodeavdelinger <- klassR::GetKlass(608, output_style = "wide", date = c(paste0(aargang, "-01-01"))) %>%
dplyr::rename(region = code1,
orgnummer_RHF = code2,
RHF = name2,
HF = name3,
orgnummer_HF = code3,
Fødeinstitusjon = name4,
ID = code4,
adresse = name5,
postnummer = code5,
lon = code6,
lat = name6) %>%
dplyr::mutate(lon = gsub(",", ".", lon),
lat = gsub(",", ".", lat),
Type = "Fødeavdeling") %>%
sf::st_as_sf(coords = c("lon", "lat"), crs = 25833)
aargang <- 2021
fodeavdelinger <- klassR::GetKlass(608, output_style = "wide", date = c(paste0(aargang, "-01-01"))) %>%
dplyr::rename(region = code1,
orgnummer_RHF = code2,
RHF = name2,
HF = name3,
orgnummer_HF = code3,
Fødeinstitusjon = name4,
ID = code4,
adresse = name5,
postnummer = code5,
lon = code6,
lat = name6) %>%
dplyr::mutate(lon = gsub(",", ".", lon),
lat = gsub(",", ".", lat),
Type = "Fødeavdeling") %>%
sf::st_as_sf(coords = c("lon", "lat"), crs = 25833)
fodestuer <- klassR::GetKlass(609, output_style = "wide", date = c(paste0(aargang, "-01-01"))) %>%
dplyr::rename(region = code1,
orgnummer_RHF = code2,
RHF = name2,
HF = name3,
orgnummer_HF = code3,
Fødeinstitusjon = name4,
ID = code4,
adresse = name5,
postnummer = code5,
lon = code6,
lat = name6) %>%
dplyr::mutate(lon = gsub(",", ".", lon),
lat = gsub(",", ".", lat),
Type = "Fødestue") %>%
sf::st_as_sf(coords = c("lon", "lat"), crs = 25833)
fodesteder_koord <- rbind(fodeavdelinger, fodestuer)
fodesteder_koord
fodeavdelinger <- klassR::GetKlass(608, output_style = "wide", date = c(paste0(aargang, "-01-01"))) %>%
dplyr::rename(region = code1,
orgnummer_RHF = code2,
RHF = name2,
HF = name3,
orgnummer_HF = code3,
Fødeinstitusjon = name4,
ID = code4,
adresse = name5,
postnummer = code5,
lon = code6,
lat = name6) %>%
dplyr::mutate(lon = gsub(",", ".", lon),
lat = gsub(",", ".", lat),
Type = "Fødeavdeling") # %>%
fodestuer <- klassR::GetKlass(609, output_style = "wide", date = c(paste0(aargang, "-01-01"))) %>%
dplyr::rename(region = code1,
orgnummer_RHF = code2,
RHF = name2,
HF = name3,
orgnummer_HF = code3,
Fødeinstitusjon = name4,
ID = code4,
adresse = name5,
postnummer = code5,
lon = code6,
lat = name6) %>%
dplyr::mutate(lon = gsub(",", ".", lon),
lat = gsub(",", ".", lat),
Type = "Fødestue") # %>%
fodesteder_koord <- rbind(fodeavdelinger, fodestuer)
View(fodesteder_koord)
fodesteder_koord <- rbind(fodeavdelinger, fodestuer) %>%
dplyr::select(Fødeinstitusjon, lon, lat)
View(fodesteder_koord)
isochrones_2 <- isochrones %>%
dplyr::left_join(fodesteder_koord, by = "Fødeinstitusjon")
View(isochrones_2)
isochrones <- isochrones %>%
dplyr::left_join(fodesteder_koord, by = "Fødeinstitusjon")
sf::st_write(isochrones, "C:/Users/rdn/Documents/Kart/isochrones_90.shp", delete_dsn = TRUE)
test <- sf::read_sf(""C:/Users/rdn/Documents/Kart/isochrones_90.shp"")
test <- sf::read_sf("C:/Users/rdn/Documents/Kart/isochrones_90.shp")
View(test)
((100000/1000) / 100 * 60.0) * 1
((100000/1000)/100*60.0)*1
((100000/1000)/100*60.0)*1.5
((100000/1000)/100*60.0)*1
((100000/1000)/100*60.0)*1.5
((100000/1000)/100*60.0)*1.15
aargang <- 2021
Sys.setlocale("LC_ALL","no_NB.utf8")
library(tidyverse)
ds <- arrow::open_dataset("C:/Users/rdn/Documents/Kart/isochrones_90.parquet")
isochrones <- ds %>%
sfarrow::read_sf_dataset()
fodeavdelinger <- klassR::GetKlass(608, output_style = "wide", date = c(paste0(aargang, "-01-01"))) %>%
dplyr::rename(region = code1,
orgnummer_RHF = code2,
RHF = name2,
HF = name3,
orgnummer_HF = code3,
Fødeinstitusjon = name4,
ID = code4,
adresse = name5,
postnummer = code5,
lon = code6,
lat = name6) %>%
dplyr::mutate(lon = gsub(",", ".", lon),
lat = gsub(",", ".", lat),
Type = "Fødeavdeling") # %>%
fodestuer <- klassR::GetKlass(609, output_style = "wide", date = c(paste0(aargang, "-01-01"))) %>%
dplyr::rename(region = code1,
orgnummer_RHF = code2,
RHF = name2,
HF = name3,
orgnummer_HF = code3,
Fødeinstitusjon = name4,
ID = code4,
adresse = name5,
postnummer = code5,
lon = code6,
lat = name6) %>%
dplyr::mutate(lon = gsub(",", ".", lon),
lat = gsub(",", ".", lat),
Type = "Fødestue") # %>%
fodesteder_koord <- rbind(fodeavdelinger, fodestuer) %>%
dplyr::select(Fødeinstitusjon, lon, lat)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 90,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 1,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 2,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 3,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 30,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 60,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
alle_2 <- isochrones %>%
dplyr::filter(minutes == 90,
Fødeinstitusjon == "Haukeland universitetssjukehus") %>%
sf::st_transform(crs = 4326)
alle_2 %>%
data.frame()
leaflet::leaflet() %>%
leaflet::addTiles() %>%
leaflet::addPolygons(data = alle_2)
